import React from 'react';

const rubyDictionary = {
  計: 'けい',
  量: 'りょう',
  活用: 'かつよう',

  器: 'き',
  動: 'うご',
  面: 'おも',
  白: 'しろ',
  感: 'かん',
  理: 'り',
  由: 'ゆ',
  江: 'え',
  戸: 'ど',
  時: 'じ',
  代: 'だい',
  両: 'りょう',
  替: 'がえ',
  屋: 'や',
  仕: 'し',
  体: 'たい',
  験: 'けん',
  通: 'つう',
  知: 'し',
  持: 'も',
  興: 'きょう',
  味: 'み',
  生活: 'せいかつ',
  社: 'しゃ',
  会: 'かい',
  守: 'まも',
  歴: 'れき',
  種: 'しゅ',
  類: 'るい',
  意: 'い',
  見: 'けん',
  自分: 'じぶん',
  選: 'せん',
  後: 'ご',
  複: 'ふく',
  数: 'すう',
  回: 'かい',
  答: 'とう',
  内: 'ない',
  他: 'た',
  計: 'けい',
  量: 'りょう',
  器: 'き',
  動: 'うご',
  面: 'おも',
  白: 'しろ',
  手順: 'てじゅん',
  値段: 'ねだん',
  自然: 'しぜん',
  正六角形: 'せいろっかっけい',
  理: 'り',
  由: 'ゆ',
  作: 'つく',
  動: 'どう',
  画: 'が',
  周囲: 'しゅうい',
  自動: 'じどう',
  万: 'まん',
  都: 'と',
  民: 'みん',
  広: 'ひろ',
  東: 'とう',
  京: 'きょう',
  検定所: 'けんていじょ',
  本: 'ほん',
  講: 'こう',
  座: 'ざ',
  会: 'かい',
  案: 'あん',
  内: 'ない',
  問: 'もん',
  機: 'き',
  種: 'しゅ',
  問: 'もん',
  全: 'ぜん',
  部: 'ぶ',
  正解: 'せいかい',
  認: 'にん',
  正: 'ただ',
  認定: 'にんてい',
  設定: 'せってい',
  一定: 'いってい',
  指定: 'してい',
  検定: 'けんてい',
  測定: 'そくてい',
  定期: 'ていき',
  定: 'さだ',
  異: 'こと',
  担当: 'たんとう',
  当: 'あ',
  順: 'じゅん',
  位: 'い',
  資: 'し',
  料: 'りょう',
  名: 'めい',
  画: 'が',
  像: 'ぞう',
  使用: 'しよう',
  年: 'ねん',
  代: 'だい',
  解: 'かい',
  説: 'せつ',
  用紙: 'ようし',

  生糸: 'きいと',
  両: 'りょう',
  替: 'がえ',
  天: 'てん',
  秤: 'びん',
  針: 'はり',
  口: 'くち',
  型: 'がた',
  銀: 'ぎん',
  貨: 'か',
  金: 'きん',
  銅: 'どう',
  階: 'かい',
  級: 'きゅう',
  地方: 'ちほう',
  銀: 'ぎん',
  価: 'か',
  値: 'ち',
  貨: 'か',
  幣: 'へい',
  交: 'こう',
  換: 'かん',
  専: 'せん',
  門: 'もん',
  家: 'いえ',
  二家: 'にけ',
  製作: 'せいさく',
  任: 'まか',
  証印: 'しょういん',
  押: 'お',
  禁止: 'きんし',
  中央: 'ちゅうおう',
  花形: 'はながた',
  環: 'わ',
  三角: 'さんかく',
  製: 'せい',
  度: 'ど',
  測: 'はか',
  制糸: 'せいし',
  厚: 'あつ',
  部分: 'ぶぶん',
  使: 'つか',
  衣服: 'いふく',
  繊: 'せん',
  細: 'さい',
  線: 'せん',
  検: 'けん',
  尺: 'しゃく',
  器: 'き',
  機: 'き',
  均: 'きん',
  衡: 'こう',
  板: 'いた',
  花: 'はな',
  環: 'かん',
  紙: 'し',
  印: 'いん',
  差: 'さ',
  動: 'どう',
  歴: 'れき',
  長: 'なが',
  求: 'もと',
  位: 'い',
  衡: 'こう',
  式: 'しき',
  差: 'さ',
  先: 'さき',
  海: 'うみ',
  苔: 'のり',
  糸: 'いと',
  機: 'き',
  種: 'しゅ',
  認: 'にん',
  繊: 'せん',
  度: 'ど',
  検: 'けん',
  査: 'さ',
  所: 'しょ',
  太: 'ふと',
  表: 'あらわ',
  尺: 'しゃく',
  器: 'き',
  棒: 'ぼう',
  計: 'けい',
  比重: 'ひじゅう',
  量: 'りょう',
  原: 'げん',
  理: 'り',
  支: 'し',
  点: 'てん',
  力: 'ちから',
  作用: 'さよう',
  用意: 'ようい',
  天: 'てん',
  秤: 'びょう',
  金: 'きん',
  銀: 'ぎん',
  銅: 'どう',
  価: 'か',
  値: 'ち',
  幣: 'へい',
  均: 'きん',
  衡: 'こう',
  権: 'けん',
  長: 'なが',
  巻: 'ま',
  差: 'さ',
  平: 'へい',
  均: 'きん',
  製糸: 'せいし',
  工: 'こう',
  横: 'よこ',
  浜: 'はま',
  神: 'こう',
  戸: 'と',
  格: 'かく',
  付: 'ふ',
  出: 'だ',
  荷: 'に',
  倒: 'たお',
  行: 'おこな',
  道: 'みち',
  乗: 'の',
  混: 'こ',
  人々: 'ひとびと',
  学年: 'がくねん',
  相手: 'あいて',
  寝具店: 'しんぐてん',
  人: 'ひと',
  集: 'しゅう',
  氏名: 'しめい',
  種別: 'しゅべつ',
  送信: 'そうしん',
  営業: 'えいぎょう',
  関連: 'かんれん',
  住: 'す',
  江戸: 'えど',
  普通: 'ふつう',
  騒音計: 'そうおんけい',
  正確: 'せいかく',
  自: 'じ',
  主: 'おも',
  様々: 'さまざま',
  流通: 'りゅうつう',
  金額: 'きんがく',
  蚕: 'さん',
  業: 'ぎょう',
  衰: 'すい',
  退: 'たい',
  状: 'じょう',
  況: 'きょう',
  幕: 'まく',
  府: 'ふ',
  統: 'とう',
  一: 'いっ',
  組: 'くみ',
  座: 'ざ',
  地: 'ち',
  巡: 'じゅん',
  周: 'しゅう',
  修: 'しゅう',
  販: 'はん',
  売: 'ばい',
  旗: 'はた',
  部品: 'ぶひん',
  計測: 'けいそく',
  始: 'はじ',
  携帯: 'けいたい',
  大: 'おお',
  注目: 'ちゅうもく',
  拡大: 'かくだい',
  縮小: 'しゅくしょう',
  文: 'ぶん',
  出現: 'しゅつげん',
  指: 'ゆび',
  画面: 'がめん',
  後: 'ご',
  藤: 'とう',
  浮か: 'う',
  浮き: 'う',
  液: 'えき',
  体: 'たい',
  密: 'みつ',
  度: 'ど',
  比: 'くら',
  意見: 'いけん',
  寄: 'よ',
  理由: 'りゆう',
  可: 'か',
  重: 'じゅう',
  太: 'ふと',
  役立: 'やくだ',
  願: 'ねが',
  必須: 'ひっす',
  無: 'な',
  確認用: 'かくにんよう',
  未就学児: 'みしゅうがくじ',
  小学校: 'しょうがっこう',
  中学校: 'ちゅうがっこう',
  高校: 'こうこう',
  年生: 'ねんせい',
  胴: 'どう',
  部: 'ぶ',
  目: 'め',
  盛: 'もり',
  金融: 'きんゆう',
  不可欠: 'ふかけつ',
  幕府: 'ばくふ',
  合格: 'ごうかく',
  不合格: 'ふごうかく',
  部: 'ぶ',
  重: 'おも',
  構: 'こう',
  成: 'せい',
  力点: 'りきてん',
  生: 'しょう',
  発生: 'はっせい',
  水: 'みず',
  中: 'ちゅう',
  持: 'も',
  軽: 'かる',
  場: 'じょう',
  重: 'おも',
  軽: 'かる',
  沈: 'しず',
  取: 'と',
  取引: 'とりひき',
  取締: 'とりしま',
  巻わく: 'まきわく',
  各地: 'かくち',
  神戸: 'こうべ',
  引: 'ひき',
  発: 'はつ',
  明: 'めい',
  日: 'に',
  庶: 'しょ',
  今: 'いま',
  寝: 'しん',
  具: 'ぐ',
  店: 'てん',
  綿: 'わた',
  道具: 'どうぐ',
  利: 'り',
  治: 'じ',
  昭: 'しょう',
  和: 'わ',
  戦前: 'せんぜん',
  一日: 'いちにち',
  考: 'かんが',
  朝: 'あさ',
  時計: 'とけい',
  確認: 'かくにん',
  開始: 'かいし',
  天気予報: 'てんきよほう',
  今日: 'きょう',
  気温: 'きおん',
  着: 'き',
  服: 'ふく',
  決: 'き',
  食: 'た',
  歯: 'は',
  大忙し: 'おおいそが',
  授業: 'じゅぎょう',
  体育: 'たいいく',
  走: 'そう',
  健康診断: 'けんこうしんだん',
  身長: 'しんちょう',
  体重: 'たいじゅう',
  給食: 'きゅうしょく',
  材料: 'ざいりょう',
  調味料: 'ちょうみりょう',
  体温: 'たいおん',
  日常: 'にちじょう',
  以外: 'いがい',
  冷蔵庫: 'れいぞうこ',
  自動車: 'じどうしゃ',
  建物: 'たてもの',
  身の回り: 'みのまわり',
  多: 'おお',
  過程: 'かてい',
  身近: 'みぢか',
  学: 'まな',
  運営: 'うんえい',
  場面: 'ばめん',
  魅力: 'みりょく',
  発信: 'はっしん',
  再現: 'さいげん',
  空間: 'くうかん',
  両替商: 'りょうがえしょう',
  職業: 'しょくぎょう',
  操作: 'そうさ',
  深: 'ふか',
  得: 'え',
  上: 'うえ',
  上下: 'じょうげ',
  仕組: 'しく',
  格付: 'かくづ',
  各: 'かく',
  自主: 'じしゅ',
  出荷: 'しゅっか',
  段階: 'だんかい',
  計算: 'けいさん',
  品質: 'ひんしつ',
  蚕糸業: 'さんしぎょう',
  少: 'すく',
  触: 'ふ',
  回転: 'かいてん',
  満足: 'まんぞく',
  複雑: 'ふくざつ',
  対象: 'たいしょう',
  年齢: 'ねんれい',
  動作: 'どうさ',
  環境: 'かんきょう',
  前: 'まえ',
  思: 'おも',
  学校: 'がっこう',
  期: 'き',
  輸: 'ゆ',
  難: 'むずか',
  付: 'つ',
  現: 'げん',
  在: 'ざい',
  距: 'きょ',
  離: 'り',
  時: 'じ',
  算出: 'さんしゅつ',
  箱: 'はこ',
  運: 'うん',
  宝: 'ほう',
  石: 'いし',
  分銅: 'ふんどう',
  必要: 'ひつよう',
  形: 'かたち',
  看板: 'かんばん',
  地図: 'ちず',
  銀行: 'ぎんこう',
  縮尺: 'しゅくしゃく',
  万分: 'まんぶん',
  交易: 'こうえき',
  記号: 'きごう',
  単: 'たん',
  位: 'い',
  物: 'もの',
  物体: 'ぶったい',
  豆: 'まめ',
  目安: 'めやす',
  図書館: 'としょかん',
  美術館: 'びじゅつかん',
  館内: 'かんない',
  昔: 'むかし',
  木: 'き',
  湿: 'しつ',
  式: 'しき',
  体: 'たい',
  積: 'せき',
  入: 'はい',
  液: 'えき',
  意: 'い',
  味: 'み',
  音圧: 'おんあつ',
  基準: 'きじゅん',
  方: 'かた',
  詳細: 'しょうさい',
  土台: 'どだい',
  保護者: 'ほごしゃ',
  向: 'こう',
  騒: 'そうおん',
  計: 'けい',
  器: 'き',
  増: 'ぞう',
  幅: 'ふく',
  置: 'ち',
  援: 'えん',
  振動: 'しんどう',
  感: 'かん',
  性: 'せい',
  特: 'とく',
  性: 'せい',
  数: 'すう',
  値: 'ち',
  環: 'かん',
  境: 'きょう',
  機: 'き',
  工: 'こう',
  事: 'じ',
  現: 'げん',
  震: 'しん',
  度: 'ど',
  浮力: 'ふりょく',
  不正解: 'ふせいかい',
  時間: 'じかん',
  基: 'もと',
  同: 'おな',
  使用: 'しよう',
  可能性: 'かのうせい',
  温度: 'おんど',
  現場: 'げんば',
  起: 'お',
  話: 'はな',
  次: 'つぎ',
  文章: 'ぶんしょう',
  言葉: 'ことば',
  声: 'ごえ',
  鳴: 'な',
  相当: 'そうとう',
  第: 'だい',
  電車: 'でんしゃ',
  測定: 'そくてい',
  出典: 'しゅってん',
  全国: 'ぜんこく',
  研: 'けん',
  協議会: 'きょうぎかい',
  小: 'ちい',
  委員会: 'いいんかい',
  小委員会: 'しょういいんかい',
  支点: 'してん',
  加: 'くわ',
  短: 'みじか',
  手: 'て',
  水平: 'すいへい',
  分: 'ぶん',
  機関: 'きかん',
  郵便局: 'ゆうびんきょく',
  裁判所: 'さいばんしょ',
  地形図: 'ちけいず',
  千分: 'せんぶん',
  実態: 'じったい',
  制度: 'せいど',
  三貨: 'さんか',
  目盛: 'めも',
  詳: 'くわ',
  見: 'み',
  示: 'しめ',
  何: 'なん',
  中: 'なか',
  選: 'えら',
  海苔: 'のり',
  生糸: 'きいと',
  左: 'ひだり',
  右: 'みぎ',
  透明: 'とうめい',
  色: 'いろ',
  推測: 'すいそく',
  違: 'ちが',
  閉: 'と',
  左右: 'さゆう',
  色々: 'いろいろ',
  変化: 'へんか',
  確: 'たしか',
  皿: 'さら',
  釣: 'つ',
  基準: 'きじゅん',
  方向: 'ほうこう',
  前置: 'ぜんち',
  様子: 'ようす',
  紹介: 'しょうかい',
  自由研究: 'じゆうけんきゅう',
  称号: 'しょうごう',
  読: 'よ',
  眺: 'なが',
  知識: 'ちしき',
  挑戦: 'ちょうせん',
  目指: 'めざ',
  学習: 'がくしゅう',
  通: 'とお',
  収納: 'しゅうのう',
  動: 'うご',
  研究: 'けんきゅう',
  騒音: 'そうおん',
  簡単: 'かんたん',
  楽: 'たの',
  進: 'すす',
  書: 'か',
  込: 'こ',
  内容: 'ないよう',
  以下: 'いか',
  含: 'ふく',
  予想: 'よそう',
  大事: 'だいじ',
  外: 'はず',
  大丈夫: 'だいじょうぶ',
  方法: 'ほうほう',
  細: 'こま',
  感想: 'かんそう',
  自由: 'じゆう',
  参考: 'さんこう',
  書籍: 'しょせき',
  記入: 'きにゅう',
  例: 'れい',
  実際: 'じっさい',
  結果: 'けっか',
  参考: 'さんこう',
  下記: 'かき',
  用: 'もち',
  宝石用: 'ほうせきよう',
  大正: 'たいしょう',
  以降: 'いこう',
  一般: 'いっぱん',
  信号: 'しんごう',
  処理: 'しょり',
  表示: 'ひょうじ',
  装置: 'そうち',
  合: 'あ',
  音: 'おと',
  振動: 'しんどう',
  感覚: 'かんかく',
  反映: 'はんえい',
  人体: 'じんたい',
  宝石: 'ほうせき',
  重: 'おも',
  振: 'ふ',
  繊維: 'せんい',
  返: 'かえ',
  糸: 'いと',
  何歳: 'なんさい',
  歳: 'さい',
  以上: 'いじょう',
  及: 'およ',
  対応: 'たいおう',
  出来: 'でき',
  無料: 'むりょう',
  最新: 'さいしん',
  推奨: 'すいしょう',
  明示: 'めいじ',
  一般的: 'いっぱんてき',
  場所: 'ばしょ',
  利用: 'りよう',
  同時: 'どうじ',
  起動: 'きどう',
  場合: 'ばあい',
  表示: 'ひょうじ',
  表現: 'ひょうげん',
  表面: 'ひょうめん',
  発表: 'はっぴょう',
  開: 'ひら',
  再: 'さい',
  解消: 'かいしょう',
  施設: 'しせつ',
  見学: 'けんがく',
  子供: 'こども',
  向: 'む',
  教: 'おし',
  水道: 'すいどう',
  店: 'みせ',
  意識: 'いしき',
  法律: 'ほうりつ',
  安全: 'あんぜん',
  安心: 'あんしん',
  支: 'ささ',
  毎年: 'まいとし',
  夏休: 'なつやす',
  親子: 'おやこ',
  教室: 'きょうしつ',
  歴史: 'れきし',
  的: 'てき',
  展示: 'てんじ',
  仕事: 'しごと',
  身: 'み',
  記念日: 'きねんび',
  開催: 'かいさい',
  健康: 'けんこう',
  食品: 'しょくひん',
  強: 'つよ',
  結: 'むす',
  情報: 'じょうほう',
  広報紙: 'こうほうし',
  参加: 'さんか',
  室: 'しつ',
  来: 'き',
  事前: 'じぜん',
  予約: 'よやく',
  展示品: 'てんじひん',
  受: 'う',
  公開: 'こうかい',
  年末: 'ねんまつ',
  日本: 'にほん',
  商品: 'しょうひん',
  品物: 'しなもの',
  浮: 'うき',
  輸出: 'ゆしゅつ',
  年始: 'ねんし',
  月: 'がつ',
  日: 'にち',
  土日: 'どにち',
  祝日: 'しゅくじつ',
  広報誌: 'こうほうし',
  大好: 'だいす',
  関: 'かか',
  休: 'やす',
  要: 'よう',
  予約: 'よやく',
  管理: 'かんり',
  指導課: 'しどうか',
  企画: 'きかく',
  調整: 'ちょうせい',
  電話: 'でんわ',
  番号: 'ばんごう',
  公式: 'こうしき',
  初: 'はじ',
  大好: 'だいす',
  歩: 'ある',
  聞: 'き',
  投稿: 'とうこう',
  文化: 'ぶんか',
  局: 'きょく',
  学習: 'がくしゅう',
  子様: 'こさま',
  際: 'さい',
  留意: 'りゅうい',
  同一: 'どういつ',
  視: 'し',
  誹謗: 'ひぼう',
  中傷: 'ちゅうしょう',
  不快: 'ふかい',
  与: 'あた',
  接: 'せっ',
  注意: 'ちゅうい',
  質問: 'しつもん',
  気: 'き',
  私: 'わたし',
  小学生: 'しょうがくせい',
  質問: 'しつもん',
  掲載: 'けいさい',
  参照: 'さんしょう',
  工作: 'こうさく',
  運賃: 'うんちん',
  電気: 'でんき',
  魂: 'たましい',
  世界: 'せかい',
  国土: 'こくど',
  交通省: 'こうつうしょう',
  院: 'いん',
  玉川: 'たまがわ',
  大学: 'だいがく',
  出版: 'しゅっぱん',
  松本: 'まつもと',
  栄寿: 'えいじゅ',
  探検: 'たんけん',
  岡谷: 'おかや',
  市立: 'しりつ',
  蚕糸: 'さんし',
  博物館: 'はくぶつかん',
  国際: 'こくさい',
  系: 'けい',
  章: 'しょう',
  著: 'ちょ',
  消費: 'しょうひ',
  存知: 'ぞんじ',
  財団: 'ざいだん',
  法人: 'ほうじん',
  協会: 'きょうかい',
  毎回: 'まいかい',
  省: 'しょう',
  利用: 'りよう',
};

const addRubyToText = (text, anotherRuby, margin = {}) => {
  const combinedRubyDictionary = { ...rubyDictionary, ...anotherRuby };

  const highlightRegex = /\/\*(.*?)\*\//g;

  const elements = [];
  let lastIndex = 0;

  text.replace(highlightRegex, (match, innerText, offset) => {
    // ハイライト前のテキストを処理
    if (offset > lastIndex) {
      elements.push(
        ...processRuby(
          text.slice(lastIndex, offset),
          combinedRubyDictionary,
          `ruby-${lastIndex}`
        )
      );
    }

    // ハイライト内のテキストを処理
    const highlightedContent = processRuby(
      innerText,
      combinedRubyDictionary,
      `highlight-${offset}`
    );
    elements.push(
      <mark key={`highlight-${offset}`}>{highlightedContent}</mark>
    );

    lastIndex = offset + match.length;
  });

  if (lastIndex < text.length) {
    elements.push(
      ...processRuby(
        text.slice(lastIndex),
        combinedRubyDictionary,
        `ruby-${lastIndex}`
      )
    );
  }

  return elements;
};

const processRuby = (text, rubyDictionary, parentKey) => {
  const rubyRegex = new RegExp(
    Object.keys(rubyDictionary)
      .sort((a, b) => b.length - a.length)
      .join('|'),
    'g'
  );

  const elements = [];
  let lastIndex = 0;

  text.replace(rubyRegex, (match, offset) => {
    if (offset > lastIndex) {
      elements.push(
        <React.Fragment key={`${parentKey}-text-${lastIndex}`}>
          {text.slice(lastIndex, offset)}
        </React.Fragment>
      );
    }

    elements.push(
      <ruby key={`${parentKey}-ruby-${offset}`}>
        {match}
        <rt>{rubyDictionary[match]}</rt>
      </ruby>
    );

    lastIndex = offset + match.length;
  });

  if (lastIndex < text.length) {
    elements.push(
      <React.Fragment key={`${parentKey}-text-${lastIndex}`}>
        {text.slice(lastIndex)}
      </React.Fragment>
    );
  }

  return elements;
};

const formatText = (text, anotherRuby) => {
  return text.split('\n').map((line, index) => (
    <React.Fragment key={`line-${index}`}>
      {addRubyToText(line, anotherRuby)}
      <br />
    </React.Fragment>
  ));
};

const TextWithRuby = ({ text, anotherRuby, margin, textAlign = 'left' }) => {
  return (
    <p
      className='rubyContainer'
      style={{ margin: margin, textAlign: textAlign }}
    >
      {formatText(text, anotherRuby)}
    </p>
  );
};

export default TextWithRuby;
